<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Home Improvement Contract Calculator</title>

  <!-- React 18 UMD -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

  <!-- Babel for JSX on static hosting -->
  <script crossorigin src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    @media print { .no-print { display: none !important; } }
    input { -webkit-appearance: none; appearance: none; }
    input:focus { outline: 2px solid #3b82f6; }
    @media (max-width: 768px) {
      .grid-cols-12 { display: block !important; }
      .grid-cols-12 > div { width: 100% !important; border-right: none !important; border-bottom: 1px solid #000; }
      .grid-cols-12 > div:last-child { border-bottom: none; }
      .mobile-stack { grid-template-columns: 1fr !important; }
      .mobile-full { width: 100% !important; }
    }
  </style>
</head>
<body class="bg-gray-100">
  <div id="root"></div>

  <script type="text/babel" data-presets="env,react">
    const { useState, useRef } = React;

    const Plus = ({ size = 24 }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none"
           stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <line x1="12" y1="5" x2="12" y2="19"></line>
        <line x1="5" y1="12" x2="19" y2="12"></line>
      </svg>
    );
    const X = ({ size = 24 }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none"
           stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <line x1="18" y1="6" x2="6" y2="18"></line>
        <line x1="6" y1="6" x2="18" y2="18"></line>
      </svg>
    );
    const Printer = ({ size = 24 }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none"
           stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <polyline points="6 9 6 2 18 2 18 9"></polyline>
        <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path>
        <rect x="6" y="14" width="12" height="8"></rect>
      </svg>
    );

    const fmt = (v) => '$' + (Number(v || 0).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g, ','));
    const parseNum = (v) => parseFloat(String(v || '').replace(/[,$]/g, '')) || 0;
    const defaultHousePct = (a) => a <= 20000 ? 10 : a < 30000 ? 9 : 8;

    /* --- Single Calculator omitted for brevity, identical to your working version --- */
    /* (keep your original SingleCalculator code here unchanged) */

    /* --- APP --- */
    function App() {
      const blank = () => ({
        id: Date.now()+Math.random(),
        customerName:'', jobNumber:'',
        contractAmount:'', cashCheck:'',
        financeAmount:'', dealerFee:'',
        creditCard:'', creditCardFee:'',
        houseFeePercent:String(defaultHousePct(0)),
        houseFeeManual:false, laborMaterial:'',
        rideAlong:'', rideAlongBonus:'',
        numVets:'', numReps:'', vetNames:[], repNames:[],
        numRideAlongs:'', rideAlongNames:[]
      });

      const [calcs,setCalcs]=useState([blank()]);
      const mainViewRef=useRef(null), printViewRef=useRef(null);

      const calcData=(c)=>{ /* same as your version */ };

      const totals = calcs.reduce((acc,c)=>{
        const d = calcData(c);
        acc.v += d.pv * parseNum(c.numVets);
        acc.r += d.pr * parseNum(c.numReps);
        acc.rideFee += parseNum(c.rideAlong);
        acc.rideBonus += parseNum(c.rideAlongBonus);
        return acc;
      },{v:0,r:0,rideFee:0,rideBonus:0});
      const totalCompany = totals.v + totals.r + totals.rideBonus;

      /* printOne and printAllFiles identical to your working version,
         but before closing buttons, insert: */
      /* <div style="text-align:right;font-size:14px;margin-top:10px">
           <strong>Total Payout (includes ride-along bonus only):</strong> ${fmt(companyPayout)}
         </div> */

      return (
        <div className="min-h-screen">
          <div id="mainView" ref={mainViewRef} className="p-4">
            <div className="bg-white rounded-lg shadow-lg p-6 mb-6 border-4 border-blue-500">
              <div className="flex justify-between items-center mb-6">
                <h1 className="text-3xl font-bold text-blue-800">ALTA CAL PROFIT SHARE</h1>
                <button
                  onClick={printAllFiles}
                  className="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg flex items-center gap-2">
                  <Printer size={24}/>PRINT ALL
                </button>
              </div>

              <div className="grid grid-cols-4 gap-4 max-w-6xl mx-auto">
                <div className="bg-gradient-to-br from-green-400 to-green-600 p-8 rounded-lg text-white">
                  <div className="text-sm font-bold mb-2">TOTAL VET PAYOUT</div>
                  <div className="text-4xl font-bold">{fmt(totals.v)}</div>
                </div>
                <div className="bg-gradient-to-br from-purple-400 to-purple-600 p-8 rounded-lg text-white">
                  <div className="text-sm font-bold mb-2">TOTAL REP PAYOUT</div>
                  <div className="text-4xl font-bold">{fmt(totals.r)}</div>
                </div>
                <div className="bg-gradient-to-br from-amber-400 to-amber-600 p-8 rounded-lg text-white">
                  <div className="text-sm font-bold mb-2">TOTAL RIDE-ALONG (FEE + BONUS)</div>
                  <div className="text-4xl font-bold">{fmt(totals.rideFee + totals.rideBonus)}</div>
                  <div className="text-xs mt-1">Bonus Only: {fmt(totals.rideBonus)}</div>
                </div>
                <div className="bg-gradient-to-br from-sky-400 to-sky-600 p-8 rounded-lg text-white">
                  <div className="text-sm font-bold mb-2">TOTAL PAYOUT (COMPANY)</div>
                  <div className="text-4xl font-bold">{fmt(totalCompany)}</div>
                  <div className="text-xs mt-1">Vet + Rep + Ride Bonus (Fee Excluded)</div>
                </div>
              </div>
            </div>

            {calcs.map((c)=>(
              <SingleCalculator key={c.id} data={c}
                onChange={(n)=>setCalcs(a=>a.map(x=>x.id===c.id?n:x))}
                onRemove={()=>setCalcs(a=>a.filter(x=>x.id!==c.id))}
                canRemove={calcs.length>1}
                onPrint={()=>{/* same printOne call */}}/>
            ))}

            <div className="text-center mt-6">
              <button
                onClick={()=>setCalcs(a=>[...a,blank()])}
                className="bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 px-8 rounded-full shadow-lg flex items-center gap-3 mx-auto text-xl">
                <Plus size={28}/>ADD NEW FILE
              </button>
            </div>
          </div>

          <div id="printView" ref={printViewRef} style={{display:'none'}}></div>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<App/>);
  </script>
</body>
</html>
